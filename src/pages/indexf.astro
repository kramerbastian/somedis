---
import { defaultLocale, supportedLocales } from '../utils/i18n';

const acceptLanguage = Astro.request.headers.get('accept-language');
const preferredLang =
  acceptLanguage?.split(',')[0].split('-')[0] || defaultLocale;

const redirectLang = supportedLocales.includes(preferredLang)
  ? preferredLang
  : defaultLocale;

if (!redirectLang) {
  throw new Error('No valid redirect language found.');
}

return Astro.redirect(`/${redirectLang}`);
---
